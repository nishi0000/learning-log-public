
# テーマ

DynamoDBとRDBでは、データの「取り方」の考え方が違う

## 目的

AWSでアプリを作るときに、  
DynamoDBを使うと何が楽で、何がつらくなるのかを判断できるようにするため。

## 本筋

DynamoDBでは、  
RDBのように「あとから条件を足してDBに探させる」ことが前提になっていない、  
という違いを理解する。

## 結論

DynamoDBは、  
**最初に決めた取り方でしか効率よくデータを取れないDB**。  
あとから条件を足すことはできるが、  
その場合は **DB側で絞れず、アプリ側で不要なデータを除外することになる**。  
それをやると、DynamoDBの「速い・安い」という利点が薄れる。

## 図解

```text
RDB（PostgreSQLなど）
アプリ
 └ SQL（WHERE句で条件指定）
    └ DBが条件を理解して必要な行だけ返す


DynamoDB
アプリ（Lambda）
 ├ userIdでデータ取得
 ├ アプリ側で
 │   ├ done=false だけ残す
 │   └ それ以外は除外
 └ DynamoDB（指定されたキーのデータをまとめて返す）
```

## 詳細

- RDBでは
    
    - 条件が増えても
        
    - WHERE句を足せば
        
    - DBが必要なデータだけ選んで返してくれる
        
    - アプリは表示処理に専念できる
        
- DynamoDBでは
    
    - 「このキーで取る」という取り方を最初に決める
        
    - その取り方以外の条件は
        
        - DBが理解して絞ることができない
            
- その結果
    
    - userId で全件取得
        
    - アプリ側で
        
        - done=true / false を判定
            
        - 表示する・しないを決める  
            という流れになりやすい
            
- これは
    
    - データ量が少ないうちは問題にならない
        
    - データが増えると
        
        - 無駄な読み取りが増える
            
        - 遅くなる
            
        - 課金も増える
            
- つまり
    
    - 条件を後から足すと
        
    - DynamoDBの強み（高速・低コスト）が活かせなくなる
        
