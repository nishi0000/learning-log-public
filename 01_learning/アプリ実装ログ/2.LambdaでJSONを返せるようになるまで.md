
## 目的

- Vue から叩ける API を自作したい
    
- まずは **「エンドポイントを叩くと JSON が返る」** ところまでを通したい
    
- 永続化や設計は考えない（ダミーデータでOK）


---

## 結論

- **API Gateway 経由の Lambda は、HTTP レスポンスの形で返さないと動かない**
    
- C# Lambda では
    
    - `APIGatewayProxyRequest` を受け取り
        
    - `APIGatewayProxyResponse` を返す必要がある
        
- JSON は「勝手に作られる」のではなく
    
    - **C# のデータを JSON 文字列にして**
        
    - それを `Body` に入れて返している
        
- 結果として  
    👉 **エンドポイントを叩くと todo っぽい JSON が返る API が完成した**
    

---

## 最初にやろうとしたこと

- Lambda（C# / .NET 8）を作成
    
- API Gateway（HTTP API）と統合
    
- `/todos` を叩いたら何か返したい
    
## 次に詰まった問題：Lambda コンソールでコードが編集できない

### 起きたこと

- AWS Lambda コンソールを開いたら
    
    > 「コードエディタは .NET 8 をサポートしていません」  
    > という表示が出た
    

### 実際の仕様

- **C# / .NET Lambda はローカル開発前提**
    
- AWS コンソールは
    
    - 表示・設定はできる
        
    - **C# コード編集はできない**
        

### 修正した理解

- C# は
    
    - ローカルでコード編集
        
    - CLI でデプロイ
        
    - AWS は実行環境
        
- 役割が完全に分かれている
    

---

## ここで出てきた新しい概念：匿名型

### 書いたコード

```csharp
var todo = new
{
    id = 1,
    title = "sample todo",
    complated = false
};
```

### 理解したこと

- これはクラスではない
    
- その場限りの **データのかたまり**
    
- JSON にしたい中身を
    
    - いったん C# の形で表しているだけ
        

### JSON 化の流れ

```csharp
var json = JsonSerializer.Serialize(todo);
```

- ここで初めて JSON 文字列になる
    

---

## 次に詰まった問題④：`using` が足りない

### 起きたこと

```csharp
var json = JsonSerializer.Serialize(todo);
```

でエラー

### 原因

- `JsonSerializer` の `using` が足りなかった
    

### 修正

```csharp
using System.Text.Json;
```

### 学んだこと

- `using` は「おまじない」ではあるが
    
- **どこにそのクラスが定義されているか**  
    を示している
    
- IDE（VS / VS Code）なら自動補完されるが
    
- AWS コンソールではそれは起きない
    

---

## 最終的に動いたコード（抜粋）

```csharp
var todo = new
{
    id = 1,
    title = "sample todo",
    complated = false
};

var json = JsonSerializer.Serialize(todo);

return new APIGatewayProxyResponse
{
    StatusCode = 200,
    Body = json,
    Headers = new Dictionary<string, string>
    {
        { "Content-Type", "application/json" }
    }
};
```

---

## 最終確認

- API Gateway のエンドポイントをブラウザで叩く
    
- 以下が表示される
    

```json
{"id":1,"title":"sample todo","complated":false}
```

👉 **「エンドポイントを叩くと、それっぽい JSON が返る API」完成**

---

## この時点でできたこと

- Lambda（C#）で API を実装
    
- API Gateway 経由で HTTP レスポンスを返す
    
- JSON の正体（文字列）を理解
    
- 「API が動くとはどういうことか」を体感


---

## ひとことで振り返り

- 詰まった原因は **「どこで何が起きているか」の境界が曖昧だったこと**
    
- Lambda / API Gateway / C# / JSON の責務を分解したら  
    一気につながった
    
- **「動いた理由を説明できる状態」になったのが最大の成果**
    
