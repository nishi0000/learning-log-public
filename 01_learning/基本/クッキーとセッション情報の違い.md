+
## 目的

Webアプリで「ログイン状態がどうやって保たれているのか」を仕組みとして理解するため。

## 本筋

- クッキーとセッション情報は何が違うのか
    
- なぜ両方が必要なのか
    
- クッキー削除・ログアウト時に何が起きるのか
    

## 結論

クッキーとセッション情報は**別物**。  
クッキーは「ブラウザ側に保存される入れ物」で、  
セッション情報は「サーバー側に保存されるユーザー状態」。

多くの場合、  
**セッション情報を識別するためのID（セッションID）をクッキーに入れてやり取りしている**。

クッキーを消すとセッション情報は使えなくなるが、  
サーバー側のセッション情報そのものはすぐには消えない。  
ログアウトは、サーバー側のセッション情報を無効化する操作。

## 図解

```text
ブラウザ
 └ クッキー
    └ セッションID（番号だけ）

サーバー
 └ セッション情報
    ├ ログイン中か
    ├ ユーザーID
    └ 権限など
```

## 詳細

- クッキー
    
    - ブラウザに保存される
        
    - 仕組みとしては「名前と値を保存できるだけ」
        
    - 中身に意味はなく、何を入れるかはアプリ次第
        
- セッション情報
    
    - サーバー側に保存される
        
    - 「このユーザーはいまどういう状態か」を持つ
        
    - 実体はサーバー内のデータ
        
- 一般的な流れ
    
    - サーバーがセッション情報を作る
        
    - それを識別するセッションIDを発行
        
    - セッションIDをクッキーに入れてブラウザに渡す
        
    - 次回以降、ブラウザはそのIDを送る
        
    - サーバーはIDを元にセッション情報を参照する
        
- クッキー削除時
    
    - ブラウザからセッションIDが消える
        
    - サーバー側のセッション情報は残る
        
    - ただしIDが来ないため参照できず、実質使えない
        
- ログアウト時
    
    - サーバー側のセッション情報を削除・無効化する
        
    - 多くの場合、クッキーも一緒に削除する
        
